"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n/* harmony import */ var _shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @shopify/shopify-api */ \"(middleware)/./node_modules/@shopify/shopify-api/lib/index.js\");\n/* harmony import */ var _shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _shopify_shopify_api_adapters_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @shopify/shopify-api/adapters/node */ \"(middleware)/./node_modules/@shopify/shopify-api/adapters/node/index.js\");\n\n\n\n\n// Initialize Shopify API\nconst shopify = (0,_shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1__.shopifyApi)({\n    apiKey: process.env.SHOPIFY_API_KEY,\n    apiSecretKey: process.env.SHOPIFY_API_SECRET,\n    scopes: process.env.SHOPIFY_APP_SCOPES?.split(\",\") || [],\n    hostName: process.env.HOST,\n    apiVersion: _shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1__.LATEST_API_VERSION,\n    isEmbeddedApp: true,\n    hostScheme: \"https\",\n    isPrivateApp: false,\n    userAgentPrefix: \"BundlrPro\",\n    adminApiAccessToken: process.env.SHOPIFY_ADMIN_ACCESS_TOKEN,\n    billing: undefined,\n    webhooks: {\n        APP_UNINSTALLED: {\n            deliveryMethod: _shopify_shopify_api__WEBPACK_IMPORTED_MODULE_1__.DeliveryMethod.Http,\n            callbackUrl: \"/api/webhooks\"\n        }\n    }\n});\nasync function middleware(request) {\n    try {\n        const response = next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n        // Add CORS headers for Shopify\n        response.headers.set(\"Access-Control-Allow-Origin\", \"*\");\n        response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n        response.headers.set(\"Access-Control-Allow-Headers\", \"*\");\n        response.headers.set(\"Access-Control-Allow-Credentials\", \"true\");\n        response.headers.set(\"Access-Control-Max-Age\", \"86400\");\n        // Comprehensive CSP for Shopify embedded app\n        response.headers.set(\"Content-Security-Policy\", `\n      frame-ancestors https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com;\n      default-src 'self' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      style-src 'self' 'unsafe-inline' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      img-src 'self' data: blob: https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      connect-src 'self' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com wss://*.shopify.com;\n      font-src 'self' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      media-src 'self' https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com https://cdn.shopify.com;\n      object-src 'none';\n      frame-src https://*.myshopify.com https://admin.shopify.com https://accounts.shopify.com https://blundrpro-development-store.myshopify.com;\n    `.replace(/\\s+/g, \" \").trim());\n        // Handle OPTIONS requests for CORS\n        if (request.method === \"OPTIONS\") {\n            return new next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"](null, {\n                status: 204,\n                headers: response.headers\n            });\n        }\n        // Skip auth for API routes and auth callback\n        if (request.nextUrl.pathname.startsWith(\"/api/\")) {\n            return response;\n        }\n        const shop = request.nextUrl.searchParams.get(\"shop\");\n        const host = request.nextUrl.searchParams.get(\"host\");\n        const shopifyCookie = request.cookies.get(\"shopify_session\");\n        // If we have a valid session cookie, allow the request\n        if (shopifyCookie) {\n            return response;\n        }\n        // If we're not in the Shopify admin context, redirect to Shopify admin\n        if (!shop || !host) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(`https://admin.shopify.com/store/${process.env.SHOPIFY_HOST}/apps/bundlrpro`);\n        }\n        // Begin auth process\n        const redirectUri = `https://${request.headers.get(\"host\")}/api/auth/callback`;\n        const authUrl = `https://${shop}/admin/oauth/authorize?client_id=${process.env.SHOPIFY_API_KEY}&scope=${process.env.SHOPIFY_APP_SCOPES}&redirect_uri=${encodeURIComponent(redirectUri)}&state=${generateNonce()}`;\n        const authResponse = next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(authUrl);\n        authResponse.cookies.set(\"shopify_oauth_state\", generateNonce(), {\n            secure: true,\n            sameSite: \"none\",\n            path: \"/\",\n            httpOnly: true\n        });\n        return authResponse;\n    } catch (error) {\n        console.error(\"Middleware error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Authentication failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Generate a random nonce for OAuth state parameter\nfunction generateNonce() {\n    return Math.random().toString(36).substring(2, 15);\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all paths except for:\n     * 1. /api routes\n     * 2. /_next (Next.js internals)\n     * 3. /static (inside /public)\n     * 4. all root files inside /public (e.g. /favicon.ico)\n     */ \"/((?!api/|_next/|_static/|[\\\\w-]+\\\\.\\\\w+).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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REUsUUFBUTtZQUNSQyxVQUFVO1lBQ1ZDLE1BQU07WUFDTkMsVUFBVTtRQUNaO1FBQ0EsT0FBT0o7SUFDVCxFQUFFLE9BQU9LLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHFCQUFxQkE7UUFDbkMsT0FBTzVELHVGQUFpQixDQUFDO1lBQUU0RCxPQUFPO1FBQXdCLEdBQUc7WUFBRXJCLFFBQVE7UUFBSTtJQUM3RTtBQUNGO0FBRUEsb0RBQW9EO0FBQ3BELFNBQVNlO0lBQ1AsT0FBT1MsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsU0FBUyxDQUFDLEdBQUc7QUFDakQ7QUFFTyxNQUFNQyxTQUFTO0lBQ3BCQyxTQUFTO1FBQ1A7Ozs7OztLQU1DLEdBQ0Q7S0FDRDtBQUNILEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgc2hvcGlmeUFwaSwgTEFURVNUX0FQSV9WRVJTSU9OIH0gZnJvbSAnQHNob3BpZnkvc2hvcGlmeS1hcGknO1xuaW1wb3J0ICdAc2hvcGlmeS9zaG9waWZ5LWFwaS9hZGFwdGVycy9ub2RlJztcbmltcG9ydCB7IERlbGl2ZXJ5TWV0aG9kIH0gZnJvbSAnQHNob3BpZnkvc2hvcGlmeS1hcGknO1xuXG4vLyBJbml0aWFsaXplIFNob3BpZnkgQVBJXG5jb25zdCBzaG9waWZ5ID0gc2hvcGlmeUFwaSh7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuU0hPUElGWV9BUElfS0VZISxcbiAgYXBpU2VjcmV0S2V5OiBwcm9jZXNzLmVudi5TSE9QSUZZX0FQSV9TRUNSRVQhLFxuICBzY29wZXM6IHByb2Nlc3MuZW52LlNIT1BJRllfQVBQX1NDT1BFUz8uc3BsaXQoJywnKSB8fCBbXSxcbiAgaG9zdE5hbWU6IHByb2Nlc3MuZW52LkhPU1QhLFxuICBhcGlWZXJzaW9uOiBMQVRFU1RfQVBJX1ZFUlNJT04sXG4gIGlzRW1iZWRkZWRBcHA6IHRydWUsXG4gIGhvc3RTY2hlbWU6ICdodHRwcycsXG4gIGlzUHJpdmF0ZUFwcDogZmFsc2UsXG4gIHVzZXJBZ2VudFByZWZpeDogJ0J1bmRsclBybycsXG4gIGFkbWluQXBpQWNjZXNzVG9rZW46IHByb2Nlc3MuZW52LlNIT1BJRllfQURNSU5fQUNDRVNTX1RPS0VOLFxuICBiaWxsaW5nOiB1bmRlZmluZWQsXG4gIHdlYmhvb2tzOiB7XG4gICAgQVBQX1VOSU5TVEFMTEVEOiB7XG4gICAgICBkZWxpdmVyeU1ldGhvZDogRGVsaXZlcnlNZXRob2QuSHR0cCxcbiAgICAgIGNhbGxiYWNrVXJsOiAnL2FwaS93ZWJob29rcycsXG4gICAgfSxcbiAgfSxcbn0pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLm5leHQoKTtcblxuICAgIC8vIEFkZCBDT1JTIGhlYWRlcnMgZm9yIFNob3BpZnlcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgJyonKTtcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsIFBPU1QsIFBVVCwgREVMRVRFLCBPUFRJT05TJyk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnKicpO1xuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFscycsICd0cnVlJyk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLU1heC1BZ2UnLCAnODY0MDAnKTtcblxuICAgIC8vIENvbXByZWhlbnNpdmUgQ1NQIGZvciBTaG9waWZ5IGVtYmVkZGVkIGFwcFxuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdDb250ZW50LVNlY3VyaXR5LVBvbGljeScsIGBcbiAgICAgIGZyYW1lLWFuY2VzdG9ycyBodHRwczovLyoubXlzaG9waWZ5LmNvbSBodHRwczovL2FkbWluLnNob3BpZnkuY29tIGh0dHBzOi8vYWNjb3VudHMuc2hvcGlmeS5jb20gaHR0cHM6Ly9ibHVuZHJwcm8tZGV2ZWxvcG1lbnQtc3RvcmUubXlzaG9waWZ5LmNvbTtcbiAgICAgIGRlZmF1bHQtc3JjICdzZWxmJyBodHRwczovLyoubXlzaG9waWZ5LmNvbSBodHRwczovL2FkbWluLnNob3BpZnkuY29tIGh0dHBzOi8vYWNjb3VudHMuc2hvcGlmeS5jb20gaHR0cHM6Ly9ibHVuZHJwcm8tZGV2ZWxvcG1lbnQtc3RvcmUubXlzaG9waWZ5LmNvbSBodHRwczovL2Nkbi5zaG9waWZ5LmNvbTtcbiAgICAgIHNjcmlwdC1zcmMgJ3NlbGYnICd1bnNhZmUtaW5saW5lJyAndW5zYWZlLWV2YWwnIGh0dHBzOi8vKi5teXNob3BpZnkuY29tIGh0dHBzOi8vYWRtaW4uc2hvcGlmeS5jb20gaHR0cHM6Ly9hY2NvdW50cy5zaG9waWZ5LmNvbSBodHRwczovL2JsdW5kcnByby1kZXZlbG9wbWVudC1zdG9yZS5teXNob3BpZnkuY29tIGh0dHBzOi8vY2RuLnNob3BpZnkuY29tO1xuICAgICAgc3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZScgaHR0cHM6Ly8qLm15c2hvcGlmeS5jb20gaHR0cHM6Ly9hZG1pbi5zaG9waWZ5LmNvbSBodHRwczovL2FjY291bnRzLnNob3BpZnkuY29tIGh0dHBzOi8vYmx1bmRycHJvLWRldmVsb3BtZW50LXN0b3JlLm15c2hvcGlmeS5jb20gaHR0cHM6Ly9jZG4uc2hvcGlmeS5jb207XG4gICAgICBpbWctc3JjICdzZWxmJyBkYXRhOiBibG9iOiBodHRwczovLyoubXlzaG9waWZ5LmNvbSBodHRwczovL2FkbWluLnNob3BpZnkuY29tIGh0dHBzOi8vYWNjb3VudHMuc2hvcGlmeS5jb20gaHR0cHM6Ly9ibHVuZHJwcm8tZGV2ZWxvcG1lbnQtc3RvcmUubXlzaG9waWZ5LmNvbSBodHRwczovL2Nkbi5zaG9waWZ5LmNvbTtcbiAgICAgIGNvbm5lY3Qtc3JjICdzZWxmJyBodHRwczovLyoubXlzaG9waWZ5LmNvbSBodHRwczovL2FkbWluLnNob3BpZnkuY29tIGh0dHBzOi8vYWNjb3VudHMuc2hvcGlmeS5jb20gaHR0cHM6Ly9ibHVuZHJwcm8tZGV2ZWxvcG1lbnQtc3RvcmUubXlzaG9waWZ5LmNvbSBodHRwczovL2Nkbi5zaG9waWZ5LmNvbSB3c3M6Ly8qLnNob3BpZnkuY29tO1xuICAgICAgZm9udC1zcmMgJ3NlbGYnIGh0dHBzOi8vKi5teXNob3BpZnkuY29tIGh0dHBzOi8vYWRtaW4uc2hvcGlmeS5jb20gaHR0cHM6Ly9hY2NvdW50cy5zaG9waWZ5LmNvbSBodHRwczovL2JsdW5kcnByby1kZXZlbG9wbWVudC1zdG9yZS5teXNob3BpZnkuY29tIGh0dHBzOi8vY2RuLnNob3BpZnkuY29tO1xuICAgICAgbWVkaWEtc3JjICdzZWxmJyBodHRwczovLyoubXlzaG9waWZ5LmNvbSBodHRwczovL2FkbWluLnNob3BpZnkuY29tIGh0dHBzOi8vYWNjb3VudHMuc2hvcGlmeS5jb20gaHR0cHM6Ly9ibHVuZHJwcm8tZGV2ZWxvcG1lbnQtc3RvcmUubXlzaG9waWZ5LmNvbSBodHRwczovL2Nkbi5zaG9waWZ5LmNvbTtcbiAgICAgIG9iamVjdC1zcmMgJ25vbmUnO1xuICAgICAgZnJhbWUtc3JjIGh0dHBzOi8vKi5teXNob3BpZnkuY29tIGh0dHBzOi8vYWRtaW4uc2hvcGlmeS5jb20gaHR0cHM6Ly9hY2NvdW50cy5zaG9waWZ5LmNvbSBodHRwczovL2JsdW5kcnByby1kZXZlbG9wbWVudC1zdG9yZS5teXNob3BpZnkuY29tO1xuICAgIGAucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKSk7XG5cbiAgICAvLyBIYW5kbGUgT1BUSU9OUyByZXF1ZXN0cyBmb3IgQ09SU1xuICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7XG4gICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShudWxsLCB7XG4gICAgICAgIHN0YXR1czogMjA0LFxuICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2tpcCBhdXRoIGZvciBBUEkgcm91dGVzIGFuZCBhdXRoIGNhbGxiYWNrXG4gICAgaWYgKHJlcXVlc3QubmV4dFVybC5wYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpLycpKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuXG4gICAgY29uc3Qgc2hvcCA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdzaG9wJyk7XG4gICAgY29uc3QgaG9zdCA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdob3N0Jyk7XG4gICAgY29uc3Qgc2hvcGlmeUNvb2tpZSA9IHJlcXVlc3QuY29va2llcy5nZXQoJ3Nob3BpZnlfc2Vzc2lvbicpO1xuXG4gICAgLy8gSWYgd2UgaGF2ZSBhIHZhbGlkIHNlc3Npb24gY29va2llLCBhbGxvdyB0aGUgcmVxdWVzdFxuICAgIGlmIChzaG9waWZ5Q29va2llKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UncmUgbm90IGluIHRoZSBTaG9waWZ5IGFkbWluIGNvbnRleHQsIHJlZGlyZWN0IHRvIFNob3BpZnkgYWRtaW5cbiAgICBpZiAoIXNob3AgfHwgIWhvc3QpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QoXG4gICAgICAgIGBodHRwczovL2FkbWluLnNob3BpZnkuY29tL3N0b3JlLyR7cHJvY2Vzcy5lbnYuU0hPUElGWV9IT1NUfS9hcHBzL2J1bmRscnByb2BcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQmVnaW4gYXV0aCBwcm9jZXNzXG4gICAgY29uc3QgcmVkaXJlY3RVcmkgPSBgaHR0cHM6Ly8ke3JlcXVlc3QuaGVhZGVycy5nZXQoJ2hvc3QnKX0vYXBpL2F1dGgvY2FsbGJhY2tgO1xuICAgIGNvbnN0IGF1dGhVcmwgPSBgaHR0cHM6Ly8ke3Nob3B9L2FkbWluL29hdXRoL2F1dGhvcml6ZT9jbGllbnRfaWQ9JHtwcm9jZXNzLmVudi5TSE9QSUZZX0FQSV9LRVl9JnNjb3BlPSR7cHJvY2Vzcy5lbnYuU0hPUElGWV9BUFBfU0NPUEVTfSZyZWRpcmVjdF91cmk9JHtlbmNvZGVVUklDb21wb25lbnQocmVkaXJlY3RVcmkpfSZzdGF0ZT0ke2dlbmVyYXRlTm9uY2UoKX1gO1xuXG4gICAgY29uc3QgYXV0aFJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KGF1dGhVcmwpO1xuICAgIGF1dGhSZXNwb25zZS5jb29raWVzLnNldCgnc2hvcGlmeV9vYXV0aF9zdGF0ZScsIGdlbmVyYXRlTm9uY2UoKSwge1xuICAgICAgc2VjdXJlOiB0cnVlLFxuICAgICAgc2FtZVNpdGU6ICdub25lJyxcbiAgICAgIHBhdGg6ICcvJyxcbiAgICAgIGh0dHBPbmx5OiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGF1dGhSZXNwb25zZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdNaWRkbGV3YXJlIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG4vLyBHZW5lcmF0ZSBhIHJhbmRvbSBub25jZSBmb3IgT0F1dGggc3RhdGUgcGFyYW1ldGVyXG5mdW5jdGlvbiBnZW5lcmF0ZU5vbmNlKCkge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDE1KTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgIC8qXG4gICAgICogTWF0Y2ggYWxsIHBhdGhzIGV4Y2VwdCBmb3I6XG4gICAgICogMS4gL2FwaSByb3V0ZXNcbiAgICAgKiAyLiAvX25leHQgKE5leHQuanMgaW50ZXJuYWxzKVxuICAgICAqIDMuIC9zdGF0aWMgKGluc2lkZSAvcHVibGljKVxuICAgICAqIDQuIGFsbCByb290IGZpbGVzIGluc2lkZSAvcHVibGljIChlLmcuIC9mYXZpY29uLmljbylcbiAgICAgKi9cbiAgICAnLygoPyFhcGkvfF9uZXh0L3xfc3RhdGljL3xbXFxcXHctXStcXFxcLlxcXFx3KykuKiknLFxuICBdLFxufTsgIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInNob3BpZnlBcGkiLCJMQVRFU1RfQVBJX1ZFUlNJT04iLCJEZWxpdmVyeU1ldGhvZCIsInNob3BpZnkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiU0hPUElGWV9BUElfS0VZIiwiYXBpU2VjcmV0S2V5IiwiU0hPUElGWV9BUElfU0VDUkVUIiwic2NvcGVzIiwiU0hPUElGWV9BUFBfU0NPUEVTIiwic3BsaXQiLCJob3N0TmFtZSIsIkhPU1QiLCJhcGlWZXJzaW9uIiwiaXNFbWJlZGRlZEFwcCIsImhvc3RTY2hlbWUiLCJpc1ByaXZhdGVBcHAiLCJ1c2VyQWdlbnRQcmVmaXgiLCJhZG1pbkFwaUFjY2Vzc1Rva2VuIiwiU0hPUElGWV9BRE1JTl9BQ0NFU1NfVE9LRU4iLCJiaWxsaW5nIiwidW5kZWZpbmVkIiwid2ViaG9va3MiLCJBUFBfVU5JTlNUQUxMRUQiLCJkZWxpdmVyeU1ldGhvZCIsIkh0dHAiLCJjYWxsYmFja1VybCIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJuZXh0IiwiaGVhZGVycyIsInNldCIsInJlcGxhY2UiLCJ0cmltIiwibWV0aG9kIiwic3RhdHVzIiwibmV4dFVybCIsInBhdGhuYW1lIiwic3RhcnRzV2l0aCIsInNob3AiLCJzZWFyY2hQYXJhbXMiLCJnZXQiLCJob3N0Iiwic2hvcGlmeUNvb2tpZSIsImNvb2tpZXMiLCJyZWRpcmVjdCIsIlNIT1BJRllfSE9TVCIsInJlZGlyZWN0VXJpIiwiYXV0aFVybCIsImVuY29kZVVSSUNvbXBvbmVudCIsImdlbmVyYXRlTm9uY2UiLCJhdXRoUmVzcG9uc2UiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsInBhdGgiLCJodHRwT25seSIsImVycm9yIiwiY29uc29sZSIsImpzb24iLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});